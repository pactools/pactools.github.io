

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Phase shift and temporal delay in PAC &mdash; pactools 0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-dataframe.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="API Documentation" href="../api.html" />
    <link rel="prev" title="Spurious PAC with spikes" href="plot_spurious_pac.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> pactools
          

          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started with pactools</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Gallery of Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="plot_peak_locking.html">Peak-locking</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_comodulogram.html">Comodulogram</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_surrogate_analysis.html">Surrogate analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_dar_model.html">Fitting a DAR model</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_mne_epoch_masking.html">Interface with MNE-python</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_grid_search.html">Grid-search and cross-validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_spurious_pac.html">Spurious PAC with spikes</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Phase shift and temporal delay in PAC</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API Documentation</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/pactools/pactools">Fork pactools on Github</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">pactools</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Gallery of Examples</a> &raquo;</li>
        
      <li>Phase shift and temporal delay in PAC</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/auto_examples/plot_phase_delay.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-examples-plot-phase-delay-py"><span class="std std-ref">here</span></a>     to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="phase-shift-and-temporal-delay-in-pac">
<span id="sphx-glr-auto-examples-plot-phase-delay-py"></span><h1>Phase shift and temporal delay in PAC<a class="headerlink" href="#phase-shift-and-temporal-delay-in-pac" title="Permalink to this headline">¶</a></h1>
<p>This example disantangles the two distinct notions of phase shift and temporal
delay in phase-amplitude coupling. The phase shift ($phi$) is the phase of the
slow oscillation which corresponds to the maximum amplitude of the fast
oscillation. The temporal delay ($tau$) is the delay between the two coupled
components. The two notions would be identical should the driver be a perfect
stationary sinusoid.</p>
<p>(1st line) When both are equal to zero, the high frequency bursts happen in
the driver’s peaks.</p>
<p>(2nd line) When $tau = 0$ and $phi != 0$, the bursts are shifted in time with
respect to the driver’s peaks, and this shift varies depending on the
instantaneous frequency of the driver.</p>
<p>(3rd line) When $tau != 0$ and $phi = 0$, the bursts are shifted in time with
respect to the driver’s peaks, and this shift is constant over the signal. In
this case, note how the driver’s phase corresponding to the bursts varies
depending on the instantaneous frequency of the driver.</p>
<p>(4th line) Both $tau$ and $phi$ can also be both non-zero.</p>
<p>The temporal delay is estimated maximizing the likelihood on DAR models.
The phase shift is extracted from a DAR model fitted with the optimal
temporal delay.</p>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p>Dupre la Tour et al. (2017). Non-linear Auto-Regressive Models for
Cross-Frequency Coupling in Neural Time Series. bioRxiv, 159731.</p>
<img alt="../_images/sphx_glr_plot_phase_delay_001.png" class="sphx-glr-single-img" src="../_images/sphx_glr_plot_phase_delay_001.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[                                        ] 0% | 0.00 sec | delays
[                                        ] 1% | 0.19 sec | delays
[                                        ] 1% | 0.35 sec | delays
[                                        ] 2% | 0.49 sec | delays
[                                        ] 2% | 0.61 sec | delays
[.                                       ] 3% | 0.72 sec | delays
[.                                       ] 4% | 0.86 sec | delays
[.                                       ] 4% | 0.97 sec | delays
[.                                       ] 5% | 1.10 sec | delays
[..                                      ] 5% | 1.29 sec | delays
[..                                      ] 6% | 1.43 sec | delays
[..                                      ] 7% | 1.56 sec | delays
[..                                      ] 7% | 1.67 sec | delays
[...                                     ] 8% | 1.78 sec | delays
[...                                     ] 8% | 1.96 sec | delays
[...                                     ] 9% | 2.10 sec | delays
[...                                     ] 10% | 2.25 sec | delays
[....                                    ] 10% | 2.38 sec | delays
[....                                    ] 11% | 2.48 sec | delays
[....                                    ] 11% | 2.61 sec | delays
[....                                    ] 12% | 2.76 sec | delays
[.....                                   ] 13% | 2.89 sec | delays
[.....                                   ] 13% | 3.00 sec | delays
[.....                                   ] 14% | 3.11 sec | delays
[.....                                   ] 14% | 3.22 sec | delays
[.....                                   ] 15% | 3.34 sec | delays
[......                                  ] 16% | 3.45 sec | delays
[......                                  ] 16% | 3.56 sec | delays
[......                                  ] 17% | 3.67 sec | delays
[......                                  ] 17% | 3.78 sec | delays
[.......                                 ] 18% | 3.89 sec | delays
[.......                                 ] 19% | 4.07 sec | delays
[.......                                 ] 19% | 4.20 sec | delays
[.......                                 ] 20% | 4.36 sec | delays
[........                                ] 20% | 4.47 sec | delays
[........                                ] 21% | 4.60 sec | delays
[........                                ] 22% | 4.71 sec | delays
[........                                ] 22% | 4.85 sec | delays
[.........                               ] 23% | 4.95 sec | delays
[.........                               ] 23% | 5.08 sec | delays
[.........                               ] 24% | 5.19 sec | delays
[.........                               ] 25% | 5.33 sec | delays
[..........                              ] 25% | 5.45 sec | delays
[..........                              ] 26% | 5.60 sec | delays
[..........                              ] 26% | 5.76 sec | delays
[..........                              ] 27% | 5.89 sec | delays
[...........                             ] 28% | 6.01 sec | delays
[...........                             ] 28% | 6.14 sec | delays
[...........                             ] 29% | 6.29 sec | delays
[...........                             ] 29% | 6.43 sec | delays
[...........                             ] 30% | 6.56 sec | delays
[............                            ] 31% | 6.67 sec | delays
[............                            ] 31% | 6.86 sec | delays
[............                            ] 32% | 6.97 sec | delays
[............                            ] 32% | 7.09 sec | delays
[.............                           ] 33% | 7.25 sec | delays
[.............                           ] 34% | 7.40 sec | delays
[.............                           ] 34% | 7.51 sec | delays
[.............                           ] 35% | 7.69 sec | delays
[..............                          ] 35% | 7.88 sec | delays
[..............                          ] 36% | 8.03 sec | delays
[..............                          ] 37% | 8.23 sec | delays
[..............                          ] 37% | 8.46 sec | delays
[...............                         ] 38% | 8.61 sec | delays
[...............                         ] 38% | 8.74 sec | delays
[...............                         ] 39% | 8.96 sec | delays
[...............                         ] 40% | 9.19 sec | delays
[................                        ] 40% | 9.33 sec | delays
[................                        ] 41% | 9.60 sec | delays
[................                        ] 41% | 9.80 sec | delays
[................                        ] 42% | 10.04 sec | delays
[.................                       ] 43% | 10.25 sec | delays
[.................                       ] 43% | 10.49 sec | delays
[.................                       ] 44% | 10.68 sec | delays
[.................                       ] 44% | 10.86 sec | delays
[.................                       ] 45% | 11.01 sec | delays
[..................                      ] 46% | 11.19 sec | delays
[..................                      ] 46% | 11.32 sec | delays
[..................                      ] 47% | 11.59 sec | delays
[..................                      ] 47% | 11.79 sec | delays
[...................                     ] 48% | 12.03 sec | delays
[...................                     ] 49% | 12.17 sec | delays
[...................                     ] 49% | 12.43 sec | delays
[...................                     ] 50% | 12.65 sec | delays
[....................                    ] 50% | 12.99 sec | delays
[....................                    ] 51% | 13.11 sec | delays
[....................                    ] 51% | 13.30 sec | delays
[....................                    ] 52% | 13.57 sec | delays
[.....................                   ] 53% | 13.86 sec | delays
[.....................                   ] 53% | 14.11 sec | delays
[.....................                   ] 54% | 14.29 sec | delays
[.....................                   ] 54% | 14.61 sec | delays
[......................                  ] 55% | 14.76 sec | delays
[......................                  ] 56% | 14.96 sec | delays
[......................                  ] 56% | 15.17 sec | delays
[......................                  ] 57% | 15.31 sec | delays
[......................                  ] 57% | 15.52 sec | delays
[.......................                 ] 58% | 15.72 sec | delays
[.......................                 ] 59% | 15.92 sec | delays
[.......................                 ] 59% | 16.16 sec | delays
[.......................                 ] 60% | 16.43 sec | delays
[........................                ] 60% | 16.66 sec | delays
[........................                ] 61% | 16.87 sec | delays
[........................                ] 62% | 17.08 sec | delays
[........................                ] 62% | 17.33 sec | delays
[.........................               ] 63% | 17.58 sec | delays
[.........................               ] 63% | 17.83 sec | delays
[.........................               ] 64% | 18.00 sec | delays
[.........................               ] 65% | 18.16 sec | delays
[..........................              ] 65% | 18.31 sec | delays
[..........................              ] 66% | 18.48 sec | delays
[..........................              ] 66% | 18.66 sec | delays
[..........................              ] 67% | 18.85 sec | delays
[...........................             ] 68% | 18.97 sec | delays
[...........................             ] 68% | 19.08 sec | delays
[...........................             ] 69% | 19.20 sec | delays
[...........................             ] 69% | 19.33 sec | delays
[............................            ] 70% | 19.70 sec | delays
[............................            ] 71% | 19.84 sec | delays
[............................            ] 71% | 19.96 sec | delays
[............................            ] 72% | 20.08 sec | delays
[............................            ] 72% | 20.20 sec | delays
[.............................           ] 73% | 20.31 sec | delays
[.............................           ] 74% | 20.44 sec | delays
[.............................           ] 74% | 20.57 sec | delays
[.............................           ] 75% | 20.68 sec | delays
[..............................          ] 75% | 20.80 sec | delays
[..............................          ] 76% | 20.92 sec | delays
[..............................          ] 77% | 21.06 sec | delays
[..............................          ] 77% | 21.23 sec | delays
[...............................         ] 78% | 21.35 sec | delays
[...............................         ] 78% | 21.47 sec | delays
[...............................         ] 79% | 21.58 sec | delays
[...............................         ] 80% | 21.69 sec | delays
[................................        ] 80% | 21.80 sec | delays
[................................        ] 81% | 21.91 sec | delays
[................................        ] 81% | 22.02 sec | delays
[................................        ] 82% | 22.13 sec | delays
[.................................       ] 83% | 22.24 sec | delays
[.................................       ] 83% | 22.35 sec | delays
[.................................       ] 84% | 22.46 sec | delays
[.................................       ] 84% | 22.57 sec | delays
[..................................      ] 85% | 22.68 sec | delays
[..................................      ] 86% | 22.80 sec | delays
[..................................      ] 86% | 22.91 sec | delays
[..................................      ] 87% | 23.02 sec | delays
[..................................      ] 87% | 23.13 sec | delays
[...................................     ] 88% | 23.24 sec | delays
[...................................     ] 89% | 23.35 sec | delays
[...................................     ] 89% | 23.46 sec | delays
[...................................     ] 90% | 23.57 sec | delays
[....................................    ] 90% | 23.68 sec | delays
[....................................    ] 91% | 23.79 sec | delays
[....................................    ] 92% | 23.90 sec | delays
[....................................    ] 92% | 24.01 sec | delays
[.....................................   ] 93% | 24.12 sec | delays
[.....................................   ] 93% | 24.23 sec | delays
[.....................................   ] 94% | 24.34 sec | delays
[.....................................   ] 95% | 24.45 sec | delays
[......................................  ] 95% | 24.57 sec | delays
[......................................  ] 96% | 24.69 sec | delays
[......................................  ] 96% | 24.79 sec | delays
[......................................  ] 97% | 24.90 sec | delays
[....................................... ] 98% | 25.02 sec | delays
[....................................... ] 98% | 25.12 sec | delays
[....................................... ] 99% | 25.23 sec | delays
[....................................... ] 99% | 25.34 sec | delays
[........................................] 100% | 25.49 sec | delays

[                                        ] 0% | 0.00 sec | delays
[                                        ] 1% | 0.11 sec | delays
[                                        ] 1% | 0.22 sec | delays
[                                        ] 2% | 0.32 sec | delays
[                                        ] 2% | 0.43 sec | delays
[.                                       ] 3% | 0.54 sec | delays
[.                                       ] 4% | 0.67 sec | delays
[.                                       ] 4% | 0.79 sec | delays
[.                                       ] 5% | 0.90 sec | delays
[..                                      ] 5% | 1.01 sec | delays
[..                                      ] 6% | 1.13 sec | delays
[..                                      ] 7% | 1.23 sec | delays
[..                                      ] 7% | 1.34 sec | delays
[...                                     ] 8% | 1.46 sec | delays
[...                                     ] 8% | 1.57 sec | delays
[...                                     ] 9% | 1.70 sec | delays
[...                                     ] 10% | 1.85 sec | delays
[....                                    ] 10% | 2.00 sec | delays
[....                                    ] 11% | 2.11 sec | delays
[....                                    ] 11% | 2.25 sec | delays
[....                                    ] 12% | 2.41 sec | delays
[.....                                   ] 13% | 2.56 sec | delays
[.....                                   ] 13% | 2.69 sec | delays
[.....                                   ] 14% | 2.85 sec | delays
[.....                                   ] 14% | 2.97 sec | delays
[.....                                   ] 15% | 3.11 sec | delays
[......                                  ] 16% | 3.24 sec | delays
[......                                  ] 16% | 3.37 sec | delays
[......                                  ] 17% | 3.48 sec | delays
[......                                  ] 17% | 3.65 sec | delays
[.......                                 ] 18% | 3.76 sec | delays
[.......                                 ] 19% | 3.88 sec | delays
[.......                                 ] 19% | 4.01 sec | delays
[.......                                 ] 20% | 4.12 sec | delays
[........                                ] 20% | 4.23 sec | delays
[........                                ] 21% | 4.34 sec | delays
[........                                ] 22% | 4.45 sec | delays
[........                                ] 22% | 4.58 sec | delays
[.........                               ] 23% | 4.69 sec | delays
[.........                               ] 23% | 4.83 sec | delays
[.........                               ] 24% | 4.94 sec | delays
[.........                               ] 25% | 5.05 sec | delays
[..........                              ] 25% | 5.20 sec | delays
[..........                              ] 26% | 5.36 sec | delays
[..........                              ] 26% | 5.55 sec | delays
[..........                              ] 27% | 5.78 sec | delays
[...........                             ] 28% | 6.03 sec | delays
[...........                             ] 28% | 6.24 sec | delays
[...........                             ] 29% | 6.51 sec | delays
[...........                             ] 29% | 6.89 sec | delays
[...........                             ] 30% | 7.36 sec | delays
[............                            ] 31% | 7.85 sec | delays
[............                            ] 31% | 8.33 sec | delays
[............                            ] 32% | 8.76 sec | delays
[............                            ] 32% | 9.22 sec | delays
[.............                           ] 33% | 9.50 sec | delays
[.............                           ] 34% | 9.80 sec | delays
[.............                           ] 34% | 10.15 sec | delays
[.............                           ] 35% | 10.58 sec | delays
[..............                          ] 35% | 10.90 sec | delays
[..............                          ] 36% | 11.21 sec | delays
[..............                          ] 37% | 11.53 sec | delays
[..............                          ] 37% | 11.86 sec | delays
[...............                         ] 38% | 12.17 sec | delays
[...............                         ] 38% | 12.55 sec | delays
[...............                         ] 39% | 12.86 sec | delays
[...............                         ] 40% | 13.18 sec | delays
[................                        ] 40% | 13.44 sec | delays
[................                        ] 41% | 13.74 sec | delays
[................                        ] 41% | 14.04 sec | delays
[................                        ] 42% | 14.30 sec | delays
[.................                       ] 43% | 14.66 sec | delays
[.................                       ] 43% | 14.97 sec | delays
[.................                       ] 44% | 15.39 sec | delays
[.................                       ] 44% | 15.80 sec | delays
[.................                       ] 45% | 16.20 sec | delays
[..................                      ] 46% | 16.50 sec | delays
[..................                      ] 46% | 16.86 sec | delays
[..................                      ] 47% | 17.29 sec | delays
[..................                      ] 47% | 17.79 sec | delays
[...................                     ] 48% | 18.21 sec | delays
[...................                     ] 49% | 18.75 sec | delays
[...................                     ] 49% | 19.12 sec | delays
[...................                     ] 50% | 19.46 sec | delays
[....................                    ] 50% | 19.78 sec | delays
[....................                    ] 51% | 20.18 sec | delays
[....................                    ] 51% | 20.42 sec | delays
[....................                    ] 52% | 20.80 sec | delays
[.....................                   ] 53% | 21.20 sec | delays
[.....................                   ] 53% | 21.63 sec | delays
[.....................                   ] 54% | 21.95 sec | delays
[.....................                   ] 54% | 22.35 sec | delays
[......................                  ] 55% | 22.75 sec | delays
[......................                  ] 56% | 23.22 sec | delays
[......................                  ] 56% | 23.73 sec | delays
[......................                  ] 57% | 24.13 sec | delays
[......................                  ] 57% | 24.33 sec | delays
[.......................                 ] 58% | 24.50 sec | delays
[.......................                 ] 59% | 24.95 sec | delays
[.......................                 ] 59% | 25.49 sec | delays
[.......................                 ] 60% | 25.85 sec | delays
[........................                ] 60% | 26.10 sec | delays
[........................                ] 61% | 26.42 sec | delays
[........................                ] 62% | 26.79 sec | delays
[........................                ] 62% | 27.20 sec | delays
[.........................               ] 63% | 27.44 sec | delays
[.........................               ] 63% | 27.68 sec | delays
[.........................               ] 64% | 27.99 sec | delays
[.........................               ] 65% | 28.40 sec | delays
[..........................              ] 65% | 28.79 sec | delays
[..........................              ] 66% | 29.16 sec | delays
[..........................              ] 66% | 29.57 sec | delays
[..........................              ] 67% | 29.95 sec | delays
[...........................             ] 68% | 30.39 sec | delays
[...........................             ] 68% | 30.84 sec | delays
[...........................             ] 69% | 31.30 sec | delays
[...........................             ] 69% | 31.71 sec | delays
[............................            ] 70% | 32.03 sec | delays
[............................            ] 71% | 32.38 sec | delays
[............................            ] 71% | 32.72 sec | delays
[............................            ] 72% | 33.13 sec | delays
[............................            ] 72% | 33.54 sec | delays
[.............................           ] 73% | 33.94 sec | delays
[.............................           ] 74% | 34.38 sec | delays
[.............................           ] 74% | 34.85 sec | delays
[.............................           ] 75% | 35.13 sec | delays
[..............................          ] 75% | 35.42 sec | delays
[..............................          ] 76% | 35.58 sec | delays
[..............................          ] 77% | 35.71 sec | delays
[..............................          ] 77% | 35.93 sec | delays
[...............................         ] 78% | 36.08 sec | delays
[...............................         ] 78% | 36.22 sec | delays
[...............................         ] 79% | 36.52 sec | delays
[...............................         ] 80% | 36.69 sec | delays
[................................        ] 80% | 36.90 sec | delays
[................................        ] 81% | 37.11 sec | delays
[................................        ] 81% | 37.47 sec | delays
[................................        ] 82% | 37.74 sec | delays
[.................................       ] 83% | 38.04 sec | delays
[.................................       ] 83% | 38.38 sec | delays
[.................................       ] 84% | 38.86 sec | delays
[.................................       ] 84% | 39.19 sec | delays
[..................................      ] 85% | 39.55 sec | delays
[..................................      ] 86% | 39.89 sec | delays
[..................................      ] 86% | 40.21 sec | delays
[..................................      ] 87% | 40.51 sec | delays
[..................................      ] 87% | 40.73 sec | delays
[...................................     ] 88% | 40.98 sec | delays
[...................................     ] 89% | 41.29 sec | delays
[...................................     ] 89% | 41.53 sec | delays
[...................................     ] 90% | 41.78 sec | delays
[....................................    ] 90% | 42.11 sec | delays
[....................................    ] 91% | 42.33 sec | delays
[....................................    ] 92% | 42.50 sec | delays
[....................................    ] 92% | 42.76 sec | delays
[.....................................   ] 93% | 42.91 sec | delays
[.....................................   ] 93% | 43.08 sec | delays
[.....................................   ] 94% | 43.28 sec | delays
[.....................................   ] 95% | 43.68 sec | delays
[......................................  ] 95% | 43.99 sec | delays
[......................................  ] 96% | 44.13 sec | delays
[......................................  ] 96% | 44.25 sec | delays
[......................................  ] 97% | 44.40 sec | delays
[....................................... ] 98% | 44.52 sec | delays
[....................................... ] 98% | 44.66 sec | delays
[....................................... ] 99% | 44.93 sec | delays
[....................................... ] 99% | 45.13 sec | delays
[........................................] 100% | 45.31 sec | delays

[                                        ] 0% | 0.00 sec | delays
[                                        ] 1% | 0.18 sec | delays
[                                        ] 1% | 0.36 sec | delays
[                                        ] 2% | 0.55 sec | delays
[                                        ] 2% | 0.76 sec | delays
[.                                       ] 3% | 1.09 sec | delays
[.                                       ] 4% | 1.31 sec | delays
[.                                       ] 4% | 1.59 sec | delays
[.                                       ] 5% | 1.83 sec | delays
[..                                      ] 5% | 2.07 sec | delays
[..                                      ] 6% | 2.32 sec | delays
[..                                      ] 7% | 2.53 sec | delays
[..                                      ] 7% | 2.74 sec | delays
[...                                     ] 8% | 2.97 sec | delays
[...                                     ] 8% | 3.14 sec | delays
[...                                     ] 9% | 3.33 sec | delays
[...                                     ] 10% | 3.50 sec | delays
[....                                    ] 10% | 3.79 sec | delays
[....                                    ] 11% | 3.97 sec | delays
[....                                    ] 11% | 4.20 sec | delays
[....                                    ] 12% | 4.43 sec | delays
[.....                                   ] 13% | 4.58 sec | delays
[.....                                   ] 13% | 4.87 sec | delays
[.....                                   ] 14% | 5.22 sec | delays
[.....                                   ] 14% | 5.44 sec | delays
[.....                                   ] 15% | 5.63 sec | delays
[......                                  ] 16% | 5.80 sec | delays
[......                                  ] 16% | 6.12 sec | delays
[......                                  ] 17% | 6.31 sec | delays
[......                                  ] 17% | 6.55 sec | delays
[.......                                 ] 18% | 6.88 sec | delays
[.......                                 ] 19% | 7.18 sec | delays
[.......                                 ] 19% | 7.32 sec | delays
[.......                                 ] 20% | 7.61 sec | delays
[........                                ] 20% | 7.87 sec | delays
[........                                ] 21% | 8.09 sec | delays
[........                                ] 22% | 8.25 sec | delays
[........                                ] 22% | 8.44 sec | delays
[.........                               ] 23% | 8.57 sec | delays
[.........                               ] 23% | 8.77 sec | delays
[.........                               ] 24% | 8.93 sec | delays
[.........                               ] 25% | 9.07 sec | delays
[..........                              ] 25% | 9.20 sec | delays
[..........                              ] 26% | 9.36 sec | delays
[..........                              ] 26% | 9.50 sec | delays
[..........                              ] 27% | 9.68 sec | delays
[...........                             ] 28% | 9.88 sec | delays
[...........                             ] 28% | 10.16 sec | delays
[...........                             ] 29% | 10.31 sec | delays
[...........                             ] 29% | 10.51 sec | delays
[...........                             ] 30% | 10.64 sec | delays
[............                            ] 31% | 10.79 sec | delays
[............                            ] 31% | 10.96 sec | delays
[............                            ] 32% | 11.14 sec | delays
[............                            ] 32% | 11.30 sec | delays
[.............                           ] 33% | 11.58 sec | delays
[.............                           ] 34% | 11.71 sec | delays
[.............                           ] 34% | 11.90 sec | delays
[.............                           ] 35% | 12.09 sec | delays
[..............                          ] 35% | 12.35 sec | delays
[..............                          ] 36% | 12.61 sec | delays
[..............                          ] 37% | 12.83 sec | delays
[..............                          ] 37% | 13.03 sec | delays
[...............                         ] 38% | 13.21 sec | delays
[...............                         ] 38% | 13.37 sec | delays
[...............                         ] 39% | 13.54 sec | delays
[...............                         ] 40% | 13.67 sec | delays
[................                        ] 40% | 13.83 sec | delays
[................                        ] 41% | 13.95 sec | delays
[................                        ] 41% | 14.08 sec | delays
[................                        ] 42% | 14.24 sec | delays
[.................                       ] 43% | 14.46 sec | delays
[.................                       ] 43% | 14.99 sec | delays
[.................                       ] 44% | 15.20 sec | delays
[.................                       ] 44% | 15.40 sec | delays
[.................                       ] 45% | 15.55 sec | delays
[..................                      ] 46% | 15.67 sec | delays
[..................                      ] 46% | 15.81 sec | delays
[..................                      ] 47% | 15.95 sec | delays
[..................                      ] 47% | 16.09 sec | delays
[...................                     ] 48% | 16.22 sec | delays
[...................                     ] 49% | 16.35 sec | delays
[...................                     ] 49% | 16.51 sec | delays
[...................                     ] 50% | 16.69 sec | delays
[....................                    ] 50% | 16.82 sec | delays
[....................                    ] 51% | 16.93 sec | delays
[....................                    ] 51% | 17.04 sec | delays
[....................                    ] 52% | 17.14 sec | delays
[.....................                   ] 53% | 17.25 sec | delays
[.....................                   ] 53% | 17.36 sec | delays
[.....................                   ] 54% | 17.47 sec | delays
[.....................                   ] 54% | 17.58 sec | delays
[......................                  ] 55% | 17.68 sec | delays
[......................                  ] 56% | 17.79 sec | delays
[......................                  ] 56% | 17.90 sec | delays
[......................                  ] 57% | 18.01 sec | delays
[......................                  ] 57% | 18.13 sec | delays
[.......................                 ] 58% | 18.25 sec | delays
[.......................                 ] 59% | 18.36 sec | delays
[.......................                 ] 59% | 18.47 sec | delays
[.......................                 ] 60% | 18.59 sec | delays
[........................                ] 60% | 18.71 sec | delays
[........................                ] 61% | 18.82 sec | delays
[........................                ] 62% | 18.97 sec | delays
[........................                ] 62% | 19.09 sec | delays
[.........................               ] 63% | 19.26 sec | delays
[.........................               ] 63% | 19.37 sec | delays
[.........................               ] 64% | 19.50 sec | delays
[.........................               ] 65% | 19.70 sec | delays
[..........................              ] 65% | 19.86 sec | delays
[..........................              ] 66% | 20.03 sec | delays
[..........................              ] 66% | 20.21 sec | delays
[..........................              ] 67% | 20.34 sec | delays
[...........................             ] 68% | 20.52 sec | delays
[...........................             ] 68% | 20.74 sec | delays
[...........................             ] 69% | 21.00 sec | delays
[...........................             ] 69% | 21.16 sec | delays
[............................            ] 70% | 21.31 sec | delays
[............................            ] 71% | 21.51 sec | delays
[............................            ] 71% | 21.82 sec | delays
[............................            ] 72% | 22.05 sec | delays
[............................            ] 72% | 22.25 sec | delays
[.............................           ] 73% | 22.41 sec | delays
[.............................           ] 74% | 22.64 sec | delays
[.............................           ] 74% | 22.80 sec | delays
[.............................           ] 75% | 23.13 sec | delays
[..............................          ] 75% | 23.34 sec | delays
[..............................          ] 76% | 23.58 sec | delays
[..............................          ] 77% | 23.78 sec | delays
[..............................          ] 77% | 24.08 sec | delays
[...............................         ] 78% | 24.41 sec | delays
[...............................         ] 78% | 24.61 sec | delays
[...............................         ] 79% | 24.88 sec | delays
[...............................         ] 80% | 25.04 sec | delays
[................................        ] 80% | 25.26 sec | delays
[................................        ] 81% | 25.45 sec | delays
[................................        ] 81% | 25.79 sec | delays
[................................        ] 82% | 25.93 sec | delays
[.................................       ] 83% | 26.11 sec | delays
[.................................       ] 83% | 26.29 sec | delays
[.................................       ] 84% | 26.52 sec | delays
[.................................       ] 84% | 26.73 sec | delays
[..................................      ] 85% | 27.02 sec | delays
[..................................      ] 86% | 27.17 sec | delays
[..................................      ] 86% | 27.32 sec | delays
[..................................      ] 87% | 27.55 sec | delays
[..................................      ] 87% | 27.74 sec | delays
[...................................     ] 88% | 27.92 sec | delays
[...................................     ] 89% | 28.24 sec | delays
[...................................     ] 89% | 28.47 sec | delays
[...................................     ] 90% | 28.76 sec | delays
[....................................    ] 90% | 28.97 sec | delays
[....................................    ] 91% | 29.16 sec | delays
[....................................    ] 92% | 29.32 sec | delays
[....................................    ] 92% | 29.51 sec | delays
[.....................................   ] 93% | 29.78 sec | delays
[.....................................   ] 93% | 30.17 sec | delays
[.....................................   ] 94% | 30.33 sec | delays
[.....................................   ] 95% | 30.48 sec | delays
[......................................  ] 95% | 30.76 sec | delays
[......................................  ] 96% | 30.87 sec | delays
[......................................  ] 96% | 31.01 sec | delays
[......................................  ] 97% | 31.19 sec | delays
[....................................... ] 98% | 31.39 sec | delays
[....................................... ] 98% | 31.64 sec | delays
[....................................... ] 99% | 31.83 sec | delays
[....................................... ] 99% | 32.02 sec | delays
[........................................] 100% | 32.17 sec | delays

[                                        ] 0% | 0.00 sec | delays
[                                        ] 1% | 0.15 sec | delays
[                                        ] 1% | 0.27 sec | delays
[                                        ] 2% | 0.41 sec | delays
[                                        ] 2% | 0.71 sec | delays
[.                                       ] 3% | 1.05 sec | delays
[.                                       ] 4% | 1.25 sec | delays
[.                                       ] 4% | 1.40 sec | delays
[.                                       ] 5% | 1.61 sec | delays
[..                                      ] 5% | 1.72 sec | delays
[..                                      ] 6% | 1.85 sec | delays
[..                                      ] 7% | 1.98 sec | delays
[..                                      ] 7% | 2.09 sec | delays
[...                                     ] 8% | 2.21 sec | delays
[...                                     ] 8% | 2.32 sec | delays
[...                                     ] 9% | 2.42 sec | delays
[...                                     ] 10% | 2.54 sec | delays
[....                                    ] 10% | 2.65 sec | delays
[....                                    ] 11% | 2.77 sec | delays
[....                                    ] 11% | 2.87 sec | delays
[....                                    ] 12% | 3.03 sec | delays
[.....                                   ] 13% | 3.16 sec | delays
[.....                                   ] 13% | 3.31 sec | delays
[.....                                   ] 14% | 3.52 sec | delays
[.....                                   ] 14% | 3.71 sec | delays
[.....                                   ] 15% | 3.91 sec | delays
[......                                  ] 16% | 4.07 sec | delays
[......                                  ] 16% | 4.23 sec | delays
[......                                  ] 17% | 4.38 sec | delays
[......                                  ] 17% | 4.58 sec | delays
[.......                                 ] 18% | 4.75 sec | delays
[.......                                 ] 19% | 4.90 sec | delays
[.......                                 ] 19% | 5.07 sec | delays
[.......                                 ] 20% | 5.34 sec | delays
[........                                ] 20% | 5.53 sec | delays
[........                                ] 21% | 5.64 sec | delays
[........                                ] 22% | 5.78 sec | delays
[........                                ] 22% | 5.91 sec | delays
[.........                               ] 23% | 6.08 sec | delays
[.........                               ] 23% | 6.24 sec | delays
[.........                               ] 24% | 6.39 sec | delays
[.........                               ] 25% | 6.54 sec | delays
[..........                              ] 25% | 6.70 sec | delays
[..........                              ] 26% | 6.83 sec | delays
[..........                              ] 26% | 6.97 sec | delays
[..........                              ] 27% | 7.16 sec | delays
[...........                             ] 28% | 7.32 sec | delays
[...........                             ] 28% | 7.47 sec | delays
[...........                             ] 29% | 7.63 sec | delays
[...........                             ] 29% | 7.78 sec | delays
[...........                             ] 30% | 7.90 sec | delays
[............                            ] 31% | 8.11 sec | delays
[............                            ] 31% | 8.32 sec | delays
[............                            ] 32% | 8.52 sec | delays
[............                            ] 32% | 8.67 sec | delays
[.............                           ] 33% | 8.82 sec | delays
[.............                           ] 34% | 9.01 sec | delays
[.............                           ] 34% | 9.21 sec | delays
[.............                           ] 35% | 9.37 sec | delays
[..............                          ] 35% | 9.51 sec | delays
[..............                          ] 36% | 9.64 sec | delays
[..............                          ] 37% | 9.79 sec | delays
[..............                          ] 37% | 9.90 sec | delays
[...............                         ] 38% | 10.03 sec | delays
[...............                         ] 38% | 10.14 sec | delays
[...............                         ] 39% | 10.25 sec | delays
[...............                         ] 40% | 10.37 sec | delays
[................                        ] 40% | 10.48 sec | delays
[................                        ] 41% | 10.60 sec | delays
[................                        ] 41% | 10.72 sec | delays
[................                        ] 42% | 10.83 sec | delays
[.................                       ] 43% | 10.94 sec | delays
[.................                       ] 43% | 11.06 sec | delays
[.................                       ] 44% | 11.18 sec | delays
[.................                       ] 44% | 11.29 sec | delays
[.................                       ] 45% | 11.40 sec | delays
[..................                      ] 46% | 11.57 sec | delays
[..................                      ] 46% | 11.73 sec | delays
[..................                      ] 47% | 11.88 sec | delays
[..................                      ] 47% | 12.03 sec | delays
[...................                     ] 48% | 12.26 sec | delays
[...................                     ] 49% | 12.43 sec | delays
[...................                     ] 49% | 12.63 sec | delays
[...................                     ] 50% | 12.76 sec | delays
[....................                    ] 50% | 12.90 sec | delays
[....................                    ] 51% | 13.06 sec | delays
[....................                    ] 51% | 13.18 sec | delays
[....................                    ] 52% | 13.30 sec | delays
[.....................                   ] 53% | 13.45 sec | delays
[.....................                   ] 53% | 13.60 sec | delays
[.....................                   ] 54% | 13.82 sec | delays
[.....................                   ] 54% | 13.93 sec | delays
[......................                  ] 55% | 14.05 sec | delays
[......................                  ] 56% | 14.22 sec | delays
[......................                  ] 56% | 14.45 sec | delays
[......................                  ] 57% | 14.60 sec | delays
[......................                  ] 57% | 14.74 sec | delays
[.......................                 ] 58% | 14.91 sec | delays
[.......................                 ] 59% | 15.06 sec | delays
[.......................                 ] 59% | 15.27 sec | delays
[.......................                 ] 60% | 15.44 sec | delays
[........................                ] 60% | 15.56 sec | delays
[........................                ] 61% | 15.68 sec | delays
[........................                ] 62% | 15.84 sec | delays
[........................                ] 62% | 15.98 sec | delays
[.........................               ] 63% | 16.14 sec | delays
[.........................               ] 63% | 16.36 sec | delays
[.........................               ] 64% | 16.49 sec | delays
[.........................               ] 65% | 16.61 sec | delays
[..........................              ] 65% | 16.72 sec | delays
[..........................              ] 66% | 16.84 sec | delays
[..........................              ] 66% | 17.00 sec | delays
[..........................              ] 67% | 17.18 sec | delays
[...........................             ] 68% | 17.29 sec | delays
[...........................             ] 68% | 17.41 sec | delays
[...........................             ] 69% | 17.52 sec | delays
[...........................             ] 69% | 17.64 sec | delays
[............................            ] 70% | 17.75 sec | delays
[............................            ] 71% | 17.87 sec | delays
[............................            ] 71% | 17.98 sec | delays
[............................            ] 72% | 18.10 sec | delays
[............................            ] 72% | 18.21 sec | delays
[.............................           ] 73% | 18.36 sec | delays
[.............................           ] 74% | 18.56 sec | delays
[.............................           ] 74% | 18.71 sec | delays
[.............................           ] 75% | 18.83 sec | delays
[..............................          ] 75% | 18.94 sec | delays
[..............................          ] 76% | 19.06 sec | delays
[..............................          ] 77% | 19.17 sec | delays
[..............................          ] 77% | 19.28 sec | delays
[...............................         ] 78% | 19.44 sec | delays
[...............................         ] 78% | 19.55 sec | delays
[...............................         ] 79% | 19.67 sec | delays
[...............................         ] 80% | 19.79 sec | delays
[................................        ] 80% | 19.91 sec | delays
[................................        ] 81% | 20.02 sec | delays
[................................        ] 81% | 20.14 sec | delays
[................................        ] 82% | 20.26 sec | delays
[.................................       ] 83% | 20.37 sec | delays
[.................................       ] 83% | 20.49 sec | delays
[.................................       ] 84% | 20.61 sec | delays
[.................................       ] 84% | 20.73 sec | delays
[..................................      ] 85% | 20.89 sec | delays
[..................................      ] 86% | 21.06 sec | delays
[..................................      ] 86% | 21.24 sec | delays
[..................................      ] 87% | 21.36 sec | delays
[..................................      ] 87% | 21.51 sec | delays
[...................................     ] 88% | 21.62 sec | delays
[...................................     ] 89% | 21.75 sec | delays
[...................................     ] 89% | 21.89 sec | delays
[...................................     ] 90% | 22.01 sec | delays
[....................................    ] 90% | 22.13 sec | delays
[....................................    ] 91% | 22.26 sec | delays
[....................................    ] 92% | 22.43 sec | delays
[....................................    ] 92% | 22.59 sec | delays
[.....................................   ] 93% | 22.71 sec | delays
[.....................................   ] 93% | 22.82 sec | delays
[.....................................   ] 94% | 22.95 sec | delays
[.....................................   ] 95% | 23.06 sec | delays
[......................................  ] 95% | 23.17 sec | delays
[......................................  ] 96% | 23.29 sec | delays
[......................................  ] 96% | 23.40 sec | delays
[......................................  ] 97% | 23.51 sec | delays
[....................................... ] 98% | 23.63 sec | delays
[....................................... ] 98% | 23.75 sec | delays
[....................................... ] 99% | 23.86 sec | delays
[....................................... ] 99% | 23.98 sec | delays
[........................................] 100% | 24.10 sec | delays
/home/tom/work/github/pactools/examples/plot_phase_delay.py:191: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">pactools.dar_model</span> <span class="kn">import</span> <a href="http://pactools.github.io/generated/pactools.dar_model.DAR.html#pactools.dar_model.DAR" title="pactools.dar_model.DAR" class="sphx-glr-backref-module-pactools-dar_model sphx-glr-backref-type-py-class"><span class="n">DAR</span></a>
<span class="kn">from</span> <span class="nn">pactools.utils</span> <span class="kn">import</span> <span class="n">peak_finder</span>
<span class="kn">from</span> <span class="nn">pactools.utils.viz</span> <span class="kn">import</span> <span class="n">phase_string</span><span class="p">,</span> <span class="n">SEABORN_PALETTES</span><span class="p">,</span> <span class="n">set_style</span>
<span class="kn">from</span> <span class="nn">pactools.delay_estimator</span> <span class="kn">import</span> <a href="http://pactools.github.io/generated/pactools.DelayEstimator.html#pactools.DelayEstimator" title="pactools.DelayEstimator" class="sphx-glr-backref-module-pactools sphx-glr-backref-type-py-class"><span class="n">DelayEstimator</span></a>

<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="n">set_style</span><span class="p">(</span><span class="n">font_scale</span><span class="o">=</span><span class="mf">1.4</span><span class="p">)</span>
<span class="n">blue</span><span class="p">,</span> <span class="n">green</span><span class="p">,</span> <span class="n">red</span><span class="p">,</span> <span class="n">purple</span><span class="p">,</span> <span class="n">yellow</span><span class="p">,</span> <span class="n">cyan</span> <span class="o">=</span> <span class="n">SEABORN_PALETTES</span><span class="p">[</span><span class="s1">&#39;deep&#39;</span><span class="p">]</span>

<span class="n">fs</span> <span class="o">=</span> <span class="mf">500.</span>  <span class="c1"># Hz</span>
<span class="n">high_fq</span> <span class="o">=</span> <span class="mf">80.0</span>  <span class="c1"># Hz</span>
<span class="n">low_fq</span> <span class="o">=</span> <span class="mf">3.0</span>  <span class="c1"># Hz</span>
<span class="n">low_fq_mod_fq</span> <span class="o">=</span> <span class="mf">0.5</span>  <span class="c1"># Hz</span>
<span class="n">plot_fq_range</span> <span class="o">=</span> <span class="p">[</span><span class="mf">40.</span><span class="p">,</span> <span class="mf">120.</span><span class="p">]</span>  <span class="c1"># Hz</span>

<span class="n">bandwidth</span> <span class="o">=</span> <span class="mf">2.0</span>  <span class="c1"># Hz</span>

<span class="n">high_fq_amp</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">low_fq_mod_amp</span> <span class="o">=</span> <span class="mf">3.0</span>

<span class="n">ratio</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">/</span> <span class="mf">6.</span>
<span class="n">phi_0</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">ratio</span>
<span class="n">delay</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.</span> <span class="o">/</span> <span class="n">low_fq</span> <span class="o">*</span> <span class="n">ratio</span>
<span class="n">offset</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.</span>
<span class="n">sharpness</span> <span class="o">=</span> <span class="mf">5.</span>
<span class="n">noise_level</span> <span class="o">=</span> <span class="mf">0.1</span>

<span class="n">n_points</span> <span class="o">=</span> <span class="mi">30000</span>
<span class="n">t_plot</span> <span class="o">=</span> <span class="mf">1.</span>  <span class="c1"># sec</span>


<span class="k">def</span> <span class="nf">sigmoid</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">sharpness</span><span class="p">):</span>
    <span class="k">return</span> <span class="mf">1.</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.exp" title="numpy.exp" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-np-data"><span class="n">np</span><span class="o">.</span><span class="n">exp</span></a><span class="p">(</span><span class="o">-</span><span class="n">sharpness</span> <span class="o">*</span> <span class="n">array</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">clean_peak_finder</span><span class="p">(</span><a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-np-class"><span class="n">sig</span></a><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Remove first peak if it is at t=0&quot;&quot;&quot;</span>
    <span class="n">peak_inds</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">peak_finder</span><span class="p">(</span><a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-np-class"><span class="n">sig</span></a><span class="p">,</span> <span class="n">thresh</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">extrema</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">peak_inds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">peak_inds</span> <span class="o">=</span> <span class="n">peak_inds</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="k">return</span> <span class="n">peak_inds</span>


<span class="k">def</span> <span class="nf">simulate_and_plot</span><span class="p">(</span><span class="n">phi_0</span><span class="p">,</span> <span class="n">delay</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.random.html#numpy.random.RandomState" title="numpy.random.RandomState" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-np-class"><span class="n">rng</span></a><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Simulate oscillations with frequency modulation&quot;&quot;&quot;</span>
    <span class="c1"># create the slow oscillations</span>
    <span class="n">time</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-np-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="n">n_points</span><span class="p">)</span> <span class="o">/</span> <span class="n">fs</span>
    <span class="n">phase</span> <span class="o">=</span> <span class="n">time</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">low_fq</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="c1"># add frequency modulation</span>
    <span class="n">phase</span> <span class="o">+=</span> <span class="n">low_fq_mod_amp</span> <span class="o">*</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.sin" title="numpy.sin" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-np-data"><span class="n">np</span><span class="o">.</span><span class="n">sin</span></a><span class="p">(</span><span class="n">time</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">low_fq_mod_fq</span><span class="p">)</span>
    <span class="n">theta</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.cos" title="numpy.cos" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-np-data"><span class="n">np</span><span class="o">.</span><span class="n">cos</span></a><span class="p">(</span><span class="n">phase</span><span class="p">)</span>

    <span class="c1"># add the fast oscillations</span>
    <span class="n">gamma</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.cos" title="numpy.cos" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-np-data"><span class="n">np</span><span class="o">.</span><span class="n">cos</span></a><span class="p">(</span><span class="n">time</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">high_fq</span><span class="p">)</span>
    <span class="n">modulation</span> <span class="o">=</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">offset</span> <span class="o">+</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.cos" title="numpy.cos" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-np-data"><span class="n">np</span><span class="o">.</span><span class="n">cos</span></a><span class="p">(</span><span class="n">phase</span> <span class="o">-</span> <span class="n">phi_0</span><span class="p">),</span>
                         <span class="n">sharpness</span><span class="p">)</span> <span class="o">*</span> <span class="n">high_fq_amp</span>
    <span class="n">gamma</span> <span class="o">*=</span> <span class="n">modulation</span>

    <span class="c1"># add a delay</span>
    <span class="n">delay_point</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">delay</span> <span class="o">*</span> <span class="n">fs</span><span class="p">)</span>
    <span class="n">gamma</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.roll" title="numpy.roll" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-np-function"><span class="n">np</span><span class="o">.</span><span class="n">roll</span></a><span class="p">(</span><span class="n">gamma</span><span class="p">,</span> <span class="n">delay_point</span><span class="p">)</span>
    <span class="n">modulation</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.roll" title="numpy.roll" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-np-function"><span class="n">np</span><span class="o">.</span><span class="n">roll</span></a><span class="p">(</span><span class="n">modulation</span><span class="p">,</span> <span class="n">delay_point</span><span class="p">)</span>

    <span class="c1"># plot the beginning of the signal</span>
    <span class="n">sel</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">t_plot</span> <span class="o">*</span> <span class="n">fs</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">lines_theta</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">[</span><span class="n">sel</span><span class="p">],</span> <span class="n">theta</span><span class="p">[</span><span class="n">sel</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">[</span><span class="n">sel</span><span class="p">],</span> <span class="n">gamma</span><span class="p">[</span><span class="n">sel</span><span class="p">])</span>
    <span class="n">lines_modulation</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">[</span><span class="n">sel</span><span class="p">],</span> <span class="n">modulation</span><span class="p">[</span><span class="n">sel</span><span class="p">])</span>

    <span class="c1"># plot the horizontal line of phi_0</span>
    <span class="k">if</span> <span class="n">delay</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="kc">False</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span>
            <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.cos" title="numpy.cos" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-np-data"><span class="n">np</span><span class="o">.</span><span class="n">cos</span></a><span class="p">(</span><span class="o">-</span><span class="n">phi_0</span><span class="p">),</span> <span class="n">time</span><span class="p">[</span><span class="n">sel</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">time</span><span class="p">[</span><span class="n">sel</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span>
            <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

    <span class="n">gamma_peak_inds</span> <span class="o">=</span> <span class="n">clean_peak_finder</span><span class="p">(</span><span class="n">modulation</span><span class="p">[</span><span class="n">sel</span><span class="p">])</span>
    <span class="n">theta_peak_inds</span> <span class="o">=</span> <span class="n">clean_peak_finder</span><span class="p">(</span><span class="n">theta</span><span class="p">[</span><span class="n">sel</span><span class="p">])</span>
    <span class="n">cosph_peak_inds</span> <span class="o">=</span> <span class="n">clean_peak_finder</span><span class="p">(</span><a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.cos" title="numpy.cos" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-np-data"><span class="n">np</span><span class="o">.</span><span class="n">cos</span></a><span class="p">(</span><span class="n">phase</span> <span class="o">-</span> <span class="n">phi_0</span><span class="p">)[</span><span class="n">sel</span><span class="p">])</span>

    <span class="c1"># plot the vertical lines of the maximum amplitude</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">time</span><span class="p">[</span><span class="n">sel</span><span class="p">][</span><span class="n">gamma_peak_inds</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

    <span class="c1"># fill vertical intervals between start_idx and stop_idx</span>
    <span class="n">start_idx</span> <span class="o">=</span> <span class="n">gamma_peak_inds</span>
    <span class="n">stop_idx</span> <span class="o">=</span> <span class="n">cosph_peak_inds</span>
    <span class="n">fill_zone</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.zeros_like" title="numpy.zeros_like" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-np-function"><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span></a><span class="p">(</span><span class="n">time</span><span class="p">[</span><span class="n">sel</span><span class="p">])</span>
    <span class="n">fill_zone</span><span class="p">[</span><a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.minimum" title="numpy.minimum" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-np-data"><span class="n">np</span><span class="o">.</span><span class="n">minimum</span></a><span class="p">(</span><a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.maximum" title="numpy.maximum" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-np-data"><span class="n">np</span><span class="o">.</span><span class="n">maximum</span></a><span class="p">(</span><span class="n">start_idx</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">sel</span><span class="o">.</span><span class="n">stop</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">fill_zone</span><span class="p">[</span><a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.minimum" title="numpy.minimum" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-np-data"><span class="n">np</span><span class="o">.</span><span class="n">minimum</span></a><span class="p">(</span><a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.maximum" title="numpy.maximum" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-np-data"><span class="n">np</span><span class="o">.</span><span class="n">maximum</span></a><span class="p">(</span><span class="n">stop_idx</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">sel</span><span class="o">.</span><span class="n">stop</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">+=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">time</span><span class="p">[</span><span class="n">sel</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.cumsum" title="numpy.cumsum" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-np-function"><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span></a><span class="p">(</span><span class="n">fill_zone</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">,</span>
                    <span class="n">color</span><span class="o">=</span><span class="n">cyan</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

    <span class="c1"># add annotations</span>
    <span class="k">if</span> <span class="n">delay</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">start_idx</span><span class="p">,</span> <span class="n">stop_idx</span><span class="p">):</span>
            <span class="n">middle</span> <span class="o">=</span> <span class="mf">0.7</span> <span class="o">*</span> <span class="n">time</span><span class="p">[</span><span class="n">sel</span><span class="p">][</span><span class="n">start</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="n">time</span><span class="p">[</span><span class="n">sel</span><span class="p">][</span><span class="n">stop</span><span class="p">]</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\tau_0$&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">middle</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">xycoords</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">phi_0</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># ax.annotate(r&quot;$\cos(\phi_0)$&quot;, (0, np.cos(phi_0)), xycoords=&#39;data&#39;)</span>
        <span class="n">ticks</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.cos" title="numpy.cos" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-np-data"><span class="n">np</span><span class="o">.</span><span class="n">cos</span></a><span class="p">(</span><span class="n">phi_0</span><span class="p">),</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">ticklabels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;-1&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\cos(\phi_0)$&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">ticks</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">ticklabels</span><span class="p">)</span>

    <span class="c1"># fill the horizontal interval between cos(phi_0) and 1</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">time</span><span class="p">[</span><span class="n">sel</span><span class="p">],</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.cos" title="numpy.cos" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-np-data"><span class="n">np</span><span class="o">.</span><span class="n">cos</span></a><span class="p">(</span><span class="n">phi_0</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">cyan</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="c1"># plot the squares of the theta peaks</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">[</span><span class="n">sel</span><span class="p">][</span><span class="n">theta_peak_inds</span><span class="p">],</span> <span class="n">theta</span><span class="p">[</span><span class="n">sel</span><span class="p">][</span><span class="n">theta_peak_inds</span><span class="p">],</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">lines_theta</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_color</span><span class="p">())</span>
    <span class="c1"># plot the circles of maximum gamma amplitude</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">[</span><span class="n">sel</span><span class="p">][</span><span class="n">gamma_peak_inds</span><span class="p">],</span> <span class="n">modulation</span><span class="p">[</span><span class="n">sel</span><span class="p">][</span><span class="n">gamma_peak_inds</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">lines_modulation</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_color</span><span class="p">())</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_plot</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.99</span><span class="p">,</span> <span class="mf">0.22</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\phi_0 = </span><span class="si">%s</span><span class="s1">$&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">phase_string</span><span class="p">(</span><span class="n">phi_0</span><span class="p">),</span> <span class="p">),</span>
            <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.99</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\tau_0 = </span><span class="si">%.0f</span><span class="s1"> \;\mathrm</span><span class="si">{ms}</span><span class="s1">$&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">delay</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span> <span class="p">),</span>
            <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">theta</span> <span class="o">+</span> <span class="n">gamma</span> <span class="o">+</span> <span class="n">noise_level</span> <span class="o">*</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.random.html#numpy.random.RandomState" title="numpy.random.RandomState" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-np-class"><span class="n">rng</span></a><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="o">*</span><span class="n">gamma</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">fit_dar_and_plot</span><span class="p">(</span><a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-np-class"><span class="n">sig</span></a><span class="p">,</span> <span class="n">ax_logl</span><span class="p">,</span> <span class="n">ax_phase</span><span class="p">,</span> <span class="n">phi_0</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">dar_model</span> <span class="o">=</span> <a href="http://pactools.github.io/generated/pactools.dar_model.DAR.html#pactools.dar_model.DAR" title="pactools.dar_model.DAR" class="sphx-glr-backref-module-pactools-dar_model sphx-glr-backref-type-py-class"><span class="n">DAR</span></a><span class="p">(</span><span class="n">ordar</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ordriv</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">est</span> <span class="o">=</span> <a href="http://pactools.github.io/generated/pactools.DelayEstimator.html#pactools.DelayEstimator" title="pactools.DelayEstimator" class="sphx-glr-backref-module-pactools sphx-glr-backref-type-py-class"><span class="n">DelayEstimator</span></a><span class="p">(</span><span class="n">fs</span><span class="p">,</span> <span class="n">dar_model</span><span class="o">=</span><span class="n">dar_model</span><span class="p">,</span> <span class="n">low_fq</span><span class="o">=</span><span class="n">low_fq</span><span class="p">,</span>
                         <span class="n">low_fq_width</span><span class="o">=</span><span class="n">bandwidth</span><span class="p">,</span>
                         <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">)</span>
    <span class="n">est</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-np-class"><span class="n">sig</span></a><span class="p">)</span>
    <span class="n">est</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax_logl</span><span class="p">)</span>

    <span class="c1"># plot the modulation of the best model</span>
    <span class="n">est</span><span class="o">.</span><span class="n">best_model_</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax_phase</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">frange</span><span class="o">=</span><span class="n">plot_fq_range</span><span class="p">)</span>

    <span class="n">ax_phase</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">ticks</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">phi_0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">]</span>
    <span class="n">ax_phase</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">ticks</span><span class="p">)</span>
    <span class="n">ax_phase</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="sa">r</span><span class="s1">&#39;$</span><span class="si">%s</span><span class="s1">$&#39;</span> <span class="o">%</span> <span class="n">phase_string</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">ticks</span><span class="p">])</span>
    <span class="n">ax_phase</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>
    <span class="n">ax_phase</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>


<span class="c1"># initialize the plots</span>
<a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.random.html#numpy.random.RandomState" title="numpy.random.RandomState" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-np-class"><span class="n">rng</span></a> <span class="o">=</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.random.html#numpy.random.RandomState" title="numpy.random.RandomState" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-np-class"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span></a><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-np-class"><span class="n">axs</span></a> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span>
                        <span class="n">gridspec_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;width_ratios&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]})</span>

<span class="c1"># loop over the four conditions</span>
<span class="k">for</span> <span class="n">phi_0_</span><span class="p">,</span> <span class="n">delay_</span><span class="p">,</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-np-class"><span class="n">axs_</span></a> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">phi_0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">phi_0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">delay</span><span class="p">,</span> <span class="n">delay</span><span class="p">],</span>
                                <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-np-class"><span class="n">axs</span></a><span class="p">):</span>
    <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-np-class"><span class="n">sig</span></a> <span class="o">=</span> <span class="n">simulate_and_plot</span><span class="p">(</span><span class="n">phi_0</span><span class="o">=</span><span class="n">phi_0_</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="n">delay_</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-np-class"><span class="n">axs_</span></a><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.random.html#numpy.random.RandomState" title="numpy.random.RandomState" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-np-class"><span class="n">rng</span></a><span class="o">=</span><a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.random.html#numpy.random.RandomState" title="numpy.random.RandomState" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-np-class"><span class="n">rng</span></a><span class="p">)</span>
    <span class="n">fit_dar_and_plot</span><span class="p">(</span><a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-np-class"><span class="n">sig</span></a><span class="p">,</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-np-class"><span class="n">axs_</span></a><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-np-class"><span class="n">axs_</span></a><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">phi_0</span><span class="o">=</span><span class="n">phi_0_</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.random.html#numpy.random.RandomState" title="numpy.random.RandomState" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-np-class"><span class="n">rng</span></a><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 2 minutes  9.210 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-plot-phase-delay-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/8a55e514bad87e45e3a2da4435c240a0/plot_phase_delay.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_phase_delay.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/1698a7a11bdf113a93ec5f687e455c77/plot_phase_delay.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_phase_delay.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../api.html" class="btn btn-neutral float-right" title="API Documentation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="plot_spurious_pac.html" class="btn btn-neutral float-left" title="Spurious PAC with spikes" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Tom Dupre la Tour

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>