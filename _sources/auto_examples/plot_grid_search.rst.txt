

.. _sphx_glr_auto_examples_plot_grid_search.py:


Grid-search and cross-validation
--------------------------------
This examples presents the interface with scikit-learn's GridSearchCV.

It creates an artificial signal with phase-amplitude coupling (PAC),
fits a DAR model over a grid-search of parameter, using cross_validation.

Cross-validation is done over epochs, with any strategy provided in
scikit-learn (KFold, ...).

Note that the score computed by a DARSklearn model is the log-likelihood from
which we subtracted the log-likelihood of an autoregressive model at order 0.
This is done to have a reference stable over cross-validation splits.




.. code-block:: python

    import pandas as pd
    import numpy as np
    import matplotlib.pyplot as plt
    from sklearn.pipeline import Pipeline

    from pactools import simulate_pac
    from pactools.grid_search import ExtractDriver, AddDriverDelay
    from pactools.grid_search import DARSklearn, MultipleArray
    from pactools.grid_search import GridSearchCVProgressBar







Let's first create an artificial signal with PAC.



.. code-block:: python


    fs = 200.  # Hz
    high_fq = 50.0  # Hz
    low_fq = 5.0  # Hz
    low_fq_width = 1.0  # Hz

    n_epochs = 3
    n_points = 10000
    noise_level = 0.4

    low_sig = np.array([
        simulate_pac(n_points=n_points, fs=fs, high_fq=high_fq, low_fq=low_fq,
                     low_fq_width=low_fq_width, noise_level=noise_level,
                     random_state=i) for i in range(n_epochs)
    ])







Let's define the model with a scikit-learn's pipeline.

In a pipeline, the output of each step is given as input to the next one.
Here #we start with `ExtractDriver`, which extracs the driver with a bandpass
#filter, and removes it from #the modeled signal with a highpass filter. Then
#we follow with `AddDriverDelay`, which adds a delay between the driver and
the #modeled signal. Finally, we define the DAR model with `DARSklearn`.



.. code-block:: python


    model = Pipeline(steps=[
        ('driver', ExtractDriver(fs=fs, low_fq=4., max_low_fq=7.,
                                 low_fq_width=low_fq_width, random_state=0)),
        ('add', AddDriverDelay()),
        ('dar', DARSklearn(fs=fs, max_ordar=100)),
    ])

    # grid of parameter on which we will loop
    param_grid = {
        'dar__ordar': np.arange(0, 110, 30),
        'dar__ordriv': [0, 1, 2],
        'add__delay': [0],
        'driver__low_fq': [3., 4., 5., 6., 7.],
        'driver__low_fq_width': [0.25, 0.5, 1.],
    }







Then we plug the model into GridSearchCV and we fit it.

This performs a grid-search with cross-validation: First, multiple train and
test sets are defined by the splitting strategy, as defined by the parameter
`cv` in GridSearchCV. Then, GridSearchCV will loop over each parameter
configuration, fitting the model on one train set and evaluating it on the
corresponding test set.



.. code-block:: python


    # Plug the model and the parameter grid into a GridSearchCV estimator
    # (GridSearchCVProgressBar is identical to GridSearchCV, but it adds a nice
    # progress bar to monitor progress.)
    gscv = GridSearchCVProgressBar(model, param_grid=param_grid,
                                   return_train_score=False, verbose=1)

    # Fit the grid-search. We use `MultipleArray` to put together low_sig and
    # high_sig. If high_sig is None, we use low_sig for both the driver and the
    # modeled signal.
    X = MultipleArray(low_sig, None)
    gscv.fit(X)





.. rst-class:: sphx-glr-script-out

 Out::

    Fitting 3 folds for each of 180 candidates, totalling 540 fits
    [                                        ] 0% | 0.00 sec | GridSearchCV     [                                        ] 0% | 0.07 sec | GridSearchCV     [                                        ] 0% | 0.14 sec | GridSearchCV     [                                        ] 1% | 0.21 sec | GridSearchCV     [                                        ] 1% | 0.28 sec | GridSearchCV     [                                        ] 1% | 0.34 sec | GridSearchCV     [                                        ] 1% | 0.41 sec | GridSearchCV     [                                        ] 1% | 0.47 sec | GridSearchCV     [                                        ] 1% | 0.54 sec | GridSearchCV     [                                        ] 2% | 0.60 sec | GridSearchCV     [                                        ] 2% | 0.67 sec | GridSearchCV     [                                        ] 2% | 0.74 sec | GridSearchCV     [                                        ] 2% | 0.81 sec | GridSearchCV     [                                        ] 2% | 0.88 sec | GridSearchCV     [.                                       ] 3% | 0.94 sec | GridSearchCV     [.                                       ] 3% | 1.01 sec | GridSearchCV     [.                                       ] 3% | 1.07 sec | GridSearchCV     [.                                       ] 3% | 1.14 sec | GridSearchCV     [.                                       ] 3% | 1.20 sec | GridSearchCV     [.                                       ] 4% | 1.27 sec | GridSearchCV     [.                                       ] 4% | 1.34 sec | GridSearchCV     [.                                       ] 4% | 1.41 sec | GridSearchCV     [.                                       ] 4% | 1.48 sec | GridSearchCV     [.                                       ] 4% | 1.54 sec | GridSearchCV     [.                                       ] 4% | 1.61 sec | GridSearchCV     [.                                       ] 5% | 1.67 sec | GridSearchCV     [.                                       ] 5% | 1.74 sec | GridSearchCV     [..                                      ] 5% | 1.80 sec | GridSearchCV     [..                                      ] 5% | 1.87 sec | GridSearchCV     [..                                      ] 5% | 1.94 sec | GridSearchCV     [..                                      ] 6% | 2.01 sec | GridSearchCV     [..                                      ] 6% | 2.07 sec | GridSearchCV     [..                                      ] 6% | 2.14 sec | GridSearchCV     [..                                      ] 6% | 2.20 sec | GridSearchCV     [..                                      ] 6% | 2.26 sec | GridSearchCV     [..                                      ] 6% | 2.33 sec | GridSearchCV     [..                                      ] 7% | 2.39 sec | GridSearchCV     [..                                      ] 7% | 2.46 sec | GridSearchCV     [..                                      ] 7% | 2.52 sec | GridSearchCV     [..                                      ] 7% | 2.59 sec | GridSearchCV     [..                                      ] 7% | 2.65 sec | GridSearchCV     [...                                     ] 8% | 2.72 sec | GridSearchCV     [...                                     ] 8% | 2.78 sec | GridSearchCV     [...                                     ] 8% | 2.84 sec | GridSearchCV     [...                                     ] 8% | 2.91 sec | GridSearchCV     [...                                     ] 8% | 2.97 sec | GridSearchCV     [...                                     ] 9% | 3.05 sec | GridSearchCV     [...                                     ] 9% | 3.12 sec | GridSearchCV     [...                                     ] 9% | 3.20 sec | GridSearchCV     [...                                     ] 9% | 3.28 sec | GridSearchCV     [...                                     ] 9% | 3.35 sec | GridSearchCV     [...                                     ] 9% | 3.42 sec | GridSearchCV     [...                                     ] 10% | 3.50 sec | GridSearchCV     [...                                     ] 10% | 3.57 sec | GridSearchCV     [....                                    ] 10% | 3.65 sec | GridSearchCV     [....                                    ] 10% | 3.72 sec | GridSearchCV     [....                                    ] 10% | 3.80 sec | GridSearchCV     [....                                    ] 11% | 3.88 sec | GridSearchCV     [....                                    ] 11% | 3.95 sec | GridSearchCV     [....                                    ] 11% | 4.02 sec | GridSearchCV     [....                                    ] 11% | 4.10 sec | GridSearchCV     [....                                    ] 11% | 4.17 sec | GridSearchCV     [....                                    ] 11% | 4.24 sec | GridSearchCV     [....                                    ] 12% | 4.32 sec | GridSearchCV     [....                                    ] 12% | 4.40 sec | GridSearchCV     [....                                    ] 12% | 4.48 sec | GridSearchCV     [....                                    ] 12% | 4.56 sec | GridSearchCV     [....                                    ] 12% | 4.64 sec | GridSearchCV     [.....                                   ] 13% | 4.72 sec | GridSearchCV     [.....                                   ] 13% | 4.81 sec | GridSearchCV     [.....                                   ] 13% | 4.88 sec | GridSearchCV     [.....                                   ] 13% | 4.97 sec | GridSearchCV     [.....                                   ] 13% | 5.06 sec | GridSearchCV     [.....                                   ] 14% | 5.13 sec | GridSearchCV     [.....                                   ] 14% | 5.21 sec | GridSearchCV     [.....                                   ] 14% | 5.31 sec | GridSearchCV     [.....                                   ] 14% | 5.38 sec | GridSearchCV     [.....                                   ] 14% | 5.46 sec | GridSearchCV     [.....                                   ] 14% | 5.53 sec | GridSearchCV     [.....                                   ] 15% | 5.61 sec | GridSearchCV     [.....                                   ] 15% | 5.68 sec | GridSearchCV     [......                                  ] 15% | 5.76 sec | GridSearchCV     [......                                  ] 15% | 5.85 sec | GridSearchCV     [......                                  ] 15% | 5.92 sec | GridSearchCV     [......                                  ] 16% | 6.01 sec | GridSearchCV     [......                                  ] 16% | 6.08 sec | GridSearchCV     [......                                  ] 16% | 6.16 sec | GridSearchCV     [......                                  ] 16% | 6.24 sec | GridSearchCV     [......                                  ] 16% | 6.32 sec | GridSearchCV     [......                                  ] 16% | 6.39 sec | GridSearchCV     [......                                  ] 17% | 6.47 sec | GridSearchCV     [......                                  ] 17% | 6.57 sec | GridSearchCV     [......                                  ] 17% | 6.67 sec | GridSearchCV     [......                                  ] 17% | 6.76 sec | GridSearchCV     [......                                  ] 17% | 6.84 sec | GridSearchCV     [.......                                 ] 18% | 6.94 sec | GridSearchCV     [.......                                 ] 18% | 7.03 sec | GridSearchCV     [.......                                 ] 18% | 7.13 sec | GridSearchCV     [.......                                 ] 18% | 7.22 sec | GridSearchCV     [.......                                 ] 18% | 7.31 sec | GridSearchCV     [.......                                 ] 19% | 7.39 sec | GridSearchCV     [.......                                 ] 19% | 7.47 sec | GridSearchCV     [.......                                 ] 19% | 7.56 sec | GridSearchCV     [.......                                 ] 19% | 7.65 sec | GridSearchCV     [.......                                 ] 19% | 7.74 sec | GridSearchCV     [.......                                 ] 19% | 7.84 sec | GridSearchCV     [.......                                 ] 20% | 7.93 sec | GridSearchCV     [.......                                 ] 20% | 8.02 sec | GridSearchCV     [........                                ] 20% | 8.10 sec | GridSearchCV     [........                                ] 20% | 8.18 sec | GridSearchCV     [........                                ] 20% | 8.27 sec | GridSearchCV     [........                                ] 21% | 8.35 sec | GridSearchCV     [........                                ] 21% | 8.44 sec | GridSearchCV     [........                                ] 21% | 8.52 sec | GridSearchCV     [........                                ] 21% | 8.62 sec | GridSearchCV     [........                                ] 21% | 8.70 sec | GridSearchCV     [........                                ] 21% | 8.78 sec | GridSearchCV     [........                                ] 22% | 8.88 sec | GridSearchCV     [........                                ] 22% | 8.99 sec | GridSearchCV     [........                                ] 22% | 9.13 sec | GridSearchCV     [........                                ] 22% | 9.22 sec | GridSearchCV     [........                                ] 22% | 9.30 sec | GridSearchCV     [.........                               ] 23% | 9.38 sec | GridSearchCV     [.........                               ] 23% | 9.46 sec | GridSearchCV     [.........                               ] 23% | 9.55 sec | GridSearchCV     [.........                               ] 23% | 9.63 sec | GridSearchCV     [.........                               ] 23% | 9.72 sec | GridSearchCV     [.........                               ] 24% | 9.80 sec | GridSearchCV     [.........                               ] 24% | 9.89 sec | GridSearchCV     [.........                               ] 24% | 9.98 sec | GridSearchCV     [.........                               ] 24% | 10.07 sec | GridSearchCV     [.........                               ] 24% | 10.16 sec | GridSearchCV     [.........                               ] 24% | 10.24 sec | GridSearchCV     [.........                               ] 25% | 10.33 sec | GridSearchCV     [.........                               ] 25% | 10.41 sec | GridSearchCV     [..........                              ] 25% | 10.49 sec | GridSearchCV     [..........                              ] 25% | 10.59 sec | GridSearchCV     [..........                              ] 25% | 10.67 sec | GridSearchCV     [..........                              ] 26% | 10.75 sec | GridSearchCV     [..........                              ] 26% | 10.82 sec | GridSearchCV     [..........                              ] 26% | 10.89 sec | GridSearchCV     [..........                              ] 26% | 10.96 sec | GridSearchCV     [..........                              ] 26% | 11.03 sec | GridSearchCV     [..........                              ] 26% | 11.10 sec | GridSearchCV     [..........                              ] 27% | 11.17 sec | GridSearchCV     [..........                              ] 27% | 11.24 sec | GridSearchCV     [..........                              ] 27% | 11.32 sec | GridSearchCV     [..........                              ] 27% | 11.41 sec | GridSearchCV     [..........                              ] 27% | 11.49 sec | GridSearchCV     [...........                             ] 28% | 11.57 sec | GridSearchCV     [...........                             ] 28% | 11.64 sec | GridSearchCV     [...........                             ] 28% | 11.71 sec | GridSearchCV     [...........                             ] 28% | 11.78 sec | GridSearchCV     [...........                             ] 28% | 11.86 sec | GridSearchCV     [...........                             ] 29% | 11.95 sec | GridSearchCV     [...........                             ] 29% | 12.04 sec | GridSearchCV     [...........                             ] 29% | 12.11 sec | GridSearchCV     [...........                             ] 29% | 12.18 sec | GridSearchCV     [...........                             ] 29% | 12.25 sec | GridSearchCV     [...........                             ] 29% | 12.33 sec | GridSearchCV     [...........                             ] 30% | 12.40 sec | GridSearchCV     [...........                             ] 30% | 12.47 sec | GridSearchCV     [............                            ] 30% | 12.54 sec | GridSearchCV     [............                            ] 30% | 12.62 sec | GridSearchCV     [............                            ] 30% | 12.69 sec | GridSearchCV     [............                            ] 31% | 12.79 sec | GridSearchCV     [............                            ] 31% | 12.88 sec | GridSearchCV     [............                            ] 31% | 12.95 sec | GridSearchCV     [............                            ] 31% | 13.03 sec | GridSearchCV     [............                            ] 31% | 13.10 sec | GridSearchCV     [............                            ] 31% | 13.20 sec | GridSearchCV     [............                            ] 32% | 13.28 sec | GridSearchCV     [............                            ] 32% | 13.35 sec | GridSearchCV     [............                            ] 32% | 13.42 sec | GridSearchCV     [............                            ] 32% | 13.51 sec | GridSearchCV     [............                            ] 32% | 13.61 sec | GridSearchCV     [.............                           ] 33% | 13.69 sec | GridSearchCV     [.............                           ] 33% | 13.76 sec | GridSearchCV     [.............                           ] 33% | 13.85 sec | GridSearchCV     [.............                           ] 33% | 13.94 sec | GridSearchCV     [.............                           ] 33% | 14.02 sec | GridSearchCV     [.............                           ] 34% | 14.12 sec | GridSearchCV     [.............                           ] 34% | 14.22 sec | GridSearchCV     [.............                           ] 34% | 14.31 sec | GridSearchCV     [.............                           ] 34% | 14.41 sec | GridSearchCV     [.............                           ] 34% | 14.55 sec | GridSearchCV     [.............                           ] 34% | 14.66 sec | GridSearchCV     [.............                           ] 35% | 14.75 sec | GridSearchCV     [.............                           ] 35% | 14.84 sec | GridSearchCV     [..............                          ] 35% | 14.93 sec | GridSearchCV     [..............                          ] 35% | 15.03 sec | GridSearchCV     [..............                          ] 35% | 15.13 sec | GridSearchCV     [..............                          ] 36% | 15.22 sec | GridSearchCV     [..............                          ] 36% | 15.32 sec | GridSearchCV     [..............                          ] 36% | 15.41 sec | GridSearchCV     [..............                          ] 36% | 15.50 sec | GridSearchCV     [..............                          ] 36% | 15.63 sec | GridSearchCV     [..............                          ] 36% | 15.75 sec | GridSearchCV     [..............                          ] 37% | 15.84 sec | GridSearchCV     [..............                          ] 37% | 15.96 sec | GridSearchCV     [..............                          ] 37% | 16.08 sec | GridSearchCV     [..............                          ] 37% | 16.17 sec | GridSearchCV     [..............                          ] 37% | 16.27 sec | GridSearchCV     [...............                         ] 38% | 16.36 sec | GridSearchCV     [...............                         ] 38% | 16.46 sec | GridSearchCV     [...............                         ] 38% | 16.55 sec | GridSearchCV     [...............                         ] 38% | 16.65 sec | GridSearchCV     [...............                         ] 38% | 16.74 sec | GridSearchCV     [...............                         ] 39% | 16.84 sec | GridSearchCV     [...............                         ] 39% | 16.93 sec | GridSearchCV     [...............                         ] 39% | 17.05 sec | GridSearchCV     [...............                         ] 39% | 17.17 sec | GridSearchCV     [...............                         ] 39% | 17.26 sec | GridSearchCV     [...............                         ] 39% | 17.35 sec | GridSearchCV     [...............                         ] 40% | 17.45 sec | GridSearchCV     [...............                         ] 40% | 17.55 sec | GridSearchCV     [................                        ] 40% | 17.68 sec | GridSearchCV     [................                        ] 40% | 17.79 sec | GridSearchCV     [................                        ] 40% | 17.89 sec | GridSearchCV     [................                        ] 41% | 17.99 sec | GridSearchCV     [................                        ] 41% | 18.08 sec | GridSearchCV     [................                        ] 41% | 18.18 sec | GridSearchCV     [................                        ] 41% | 18.27 sec | GridSearchCV     [................                        ] 41% | 18.37 sec | GridSearchCV     [................                        ] 41% | 18.46 sec | GridSearchCV     [................                        ] 42% | 18.55 sec | GridSearchCV     [................                        ] 42% | 18.70 sec | GridSearchCV     [................                        ] 42% | 18.83 sec | GridSearchCV     [................                        ] 42% | 18.96 sec | GridSearchCV     [................                        ] 42% | 19.09 sec | GridSearchCV     [.................                       ] 43% | 19.21 sec | GridSearchCV     [.................                       ] 43% | 19.33 sec | GridSearchCV     [.................                       ] 43% | 19.45 sec | GridSearchCV     [.................                       ] 43% | 19.57 sec | GridSearchCV     [.................                       ] 43% | 19.69 sec | GridSearchCV     [.................                       ] 44% | 19.82 sec | GridSearchCV     [.................                       ] 44% | 19.95 sec | GridSearchCV     [.................                       ] 44% | 20.07 sec | GridSearchCV     [.................                       ] 44% | 20.19 sec | GridSearchCV     [.................                       ] 44% | 20.31 sec | GridSearchCV     [.................                       ] 44% | 20.44 sec | GridSearchCV     [.................                       ] 45% | 20.56 sec | GridSearchCV     [.................                       ] 45% | 20.68 sec | GridSearchCV     [..................                      ] 45% | 20.86 sec | GridSearchCV     [..................                      ] 45% | 20.98 sec | GridSearchCV     [..................                      ] 45% | 21.11 sec | GridSearchCV     [..................                      ] 46% | 21.23 sec | GridSearchCV     [..................                      ] 46% | 21.35 sec | GridSearchCV     [..................                      ] 46% | 21.47 sec | GridSearchCV     [..................                      ] 46% | 21.59 sec | GridSearchCV     [..................                      ] 46% | 21.71 sec | GridSearchCV     [..................                      ] 46% | 21.84 sec | GridSearchCV     [..................                      ] 47% | 21.96 sec | GridSearchCV     [..................                      ] 47% | 22.08 sec | GridSearchCV     [..................                      ] 47% | 22.20 sec | GridSearchCV     [..................                      ] 47% | 22.33 sec | GridSearchCV     [..................                      ] 47% | 22.45 sec | GridSearchCV     [...................                     ] 48% | 22.57 sec | GridSearchCV     [...................                     ] 48% | 22.70 sec | GridSearchCV     [...................                     ] 48% | 22.82 sec | GridSearchCV     [...................                     ] 48% | 22.94 sec | GridSearchCV     [...................                     ] 48% | 23.06 sec | GridSearchCV     [...................                     ] 49% | 23.19 sec | GridSearchCV     [...................                     ] 49% | 23.31 sec | GridSearchCV     [...................                     ] 49% | 23.44 sec | GridSearchCV     [...................                     ] 49% | 23.57 sec | GridSearchCV     [...................                     ] 49% | 23.69 sec | GridSearchCV     [...................                     ] 49% | 23.81 sec | GridSearchCV     [...................                     ] 50% | 23.93 sec | GridSearchCV     [...................                     ] 50% | 24.06 sec | GridSearchCV     [....................                    ] 50% | 24.18 sec | GridSearchCV     [....................                    ] 50% | 24.26 sec | GridSearchCV     [....................                    ] 50% | 24.34 sec | GridSearchCV     [....................                    ] 51% | 24.42 sec | GridSearchCV     [....................                    ] 51% | 24.50 sec | GridSearchCV     [....................                    ] 51% | 24.58 sec | GridSearchCV     [....................                    ] 51% | 24.65 sec | GridSearchCV     [....................                    ] 51% | 24.73 sec | GridSearchCV     [....................                    ] 51% | 24.81 sec | GridSearchCV     [....................                    ] 52% | 24.89 sec | GridSearchCV     [....................                    ] 52% | 24.97 sec | GridSearchCV     [....................                    ] 52% | 25.05 sec | GridSearchCV     [....................                    ] 52% | 25.13 sec | GridSearchCV     [....................                    ] 52% | 25.21 sec | GridSearchCV     [.....................                   ] 53% | 25.29 sec | GridSearchCV     [.....................                   ] 53% | 25.36 sec | GridSearchCV     [.....................                   ] 53% | 25.44 sec | GridSearchCV     [.....................                   ] 53% | 25.52 sec | GridSearchCV     [.....................                   ] 53% | 25.60 sec | GridSearchCV     [.....................                   ] 54% | 25.68 sec | GridSearchCV     [.....................                   ] 54% | 25.76 sec | GridSearchCV     [.....................                   ] 54% | 25.84 sec | GridSearchCV     [.....................                   ] 54% | 25.92 sec | GridSearchCV     [.....................                   ] 54% | 26.00 sec | GridSearchCV     [.....................                   ] 54% | 26.08 sec | GridSearchCV     [.....................                   ] 55% | 26.15 sec | GridSearchCV     [.....................                   ] 55% | 26.23 sec | GridSearchCV     [......................                  ] 55% | 26.31 sec | GridSearchCV     [......................                  ] 55% | 26.39 sec | GridSearchCV     [......................                  ] 55% | 26.47 sec | GridSearchCV     [......................                  ] 56% | 26.55 sec | GridSearchCV     [......................                  ] 56% | 26.63 sec | GridSearchCV     [......................                  ] 56% | 26.71 sec | GridSearchCV     [......................                  ] 56% | 26.79 sec | GridSearchCV     [......................                  ] 56% | 26.87 sec | GridSearchCV     [......................                  ] 56% | 26.95 sec | GridSearchCV     [......................                  ] 57% | 27.03 sec | GridSearchCV     [......................                  ] 57% | 27.11 sec | GridSearchCV     [......................                  ] 57% | 27.19 sec | GridSearchCV     [......................                  ] 57% | 27.27 sec | GridSearchCV     [......................                  ] 57% | 27.38 sec | GridSearchCV     [.......................                 ] 58% | 27.46 sec | GridSearchCV     [.......................                 ] 58% | 27.54 sec | GridSearchCV     [.......................                 ] 58% | 27.61 sec | GridSearchCV     [.......................                 ] 58% | 27.69 sec | GridSearchCV     [.......................                 ] 58% | 27.77 sec | GridSearchCV     [.......................                 ] 59% | 27.89 sec | GridSearchCV     [.......................                 ] 59% | 28.05 sec | GridSearchCV     [.......................                 ] 59% | 28.17 sec | GridSearchCV     [.......................                 ] 59% | 28.29 sec | GridSearchCV     [.......................                 ] 59% | 28.41 sec | GridSearchCV     [.......................                 ] 59% | 28.54 sec | GridSearchCV     [.......................                 ] 60% | 28.71 sec | GridSearchCV     [.......................                 ] 60% | 28.83 sec | GridSearchCV     [........................                ] 60% | 28.94 sec | GridSearchCV     [........................                ] 60% | 29.06 sec | GridSearchCV     [........................                ] 60% | 29.19 sec | GridSearchCV     [........................                ] 61% | 29.33 sec | GridSearchCV     [........................                ] 61% | 29.49 sec | GridSearchCV     [........................                ] 61% | 29.61 sec | GridSearchCV     [........................                ] 61% | 29.73 sec | GridSearchCV     [........................                ] 61% | 29.85 sec | GridSearchCV     [........................                ] 61% | 30.01 sec | GridSearchCV     [........................                ] 62% | 30.14 sec | GridSearchCV     [........................                ] 62% | 30.26 sec | GridSearchCV     [........................                ] 62% | 30.38 sec | GridSearchCV     [........................                ] 62% | 30.50 sec | GridSearchCV     [........................                ] 62% | 30.62 sec | GridSearchCV     [.........................               ] 63% | 30.74 sec | GridSearchCV     [.........................               ] 63% | 30.85 sec | GridSearchCV     [.........................               ] 63% | 30.97 sec | GridSearchCV     [.........................               ] 63% | 31.09 sec | GridSearchCV     [.........................               ] 63% | 31.20 sec | GridSearchCV     [.........................               ] 64% | 31.32 sec | GridSearchCV     [.........................               ] 64% | 31.44 sec | GridSearchCV     [.........................               ] 64% | 31.57 sec | GridSearchCV     [.........................               ] 64% | 31.72 sec | GridSearchCV     [.........................               ] 64% | 31.86 sec | GridSearchCV     [.........................               ] 64% | 31.98 sec | GridSearchCV     [.........................               ] 65% | 32.10 sec | GridSearchCV     [.........................               ] 65% | 32.21 sec | GridSearchCV     [..........................              ] 65% | 32.33 sec | GridSearchCV     [..........................              ] 65% | 32.50 sec | GridSearchCV     [..........................              ] 65% | 32.62 sec | GridSearchCV     [..........................              ] 66% | 32.74 sec | GridSearchCV     [..........................              ] 66% | 32.86 sec | GridSearchCV     [..........................              ] 66% | 32.98 sec | GridSearchCV     [..........................              ] 66% | 33.10 sec | GridSearchCV     [..........................              ] 66% | 33.21 sec | GridSearchCV     [..........................              ] 66% | 33.33 sec | GridSearchCV     [..........................              ] 67% | 33.45 sec | GridSearchCV     [..........................              ] 67% | 33.66 sec | GridSearchCV     [..........................              ] 67% | 33.91 sec | GridSearchCV     [..........................              ] 67% | 34.13 sec | GridSearchCV     [..........................              ] 67% | 34.34 sec | GridSearchCV     [...........................             ] 68% | 34.54 sec | GridSearchCV     [...........................             ] 68% | 34.76 sec | GridSearchCV     [...........................             ] 68% | 34.96 sec | GridSearchCV     [...........................             ] 68% | 35.24 sec | GridSearchCV     [...........................             ] 68% | 35.44 sec | GridSearchCV     [...........................             ] 69% | 35.65 sec | GridSearchCV     [...........................             ] 69% | 35.92 sec | GridSearchCV     [...........................             ] 69% | 36.13 sec | GridSearchCV     [...........................             ] 69% | 36.33 sec | GridSearchCV     [...........................             ] 69% | 36.60 sec | GridSearchCV     [...........................             ] 69% | 36.81 sec | GridSearchCV     [...........................             ] 70% | 37.01 sec | GridSearchCV     [...........................             ] 70% | 37.21 sec | GridSearchCV     [............................            ] 70% | 37.45 sec | GridSearchCV     [............................            ] 70% | 37.65 sec | GridSearchCV     [............................            ] 70% | 37.85 sec | GridSearchCV     [............................            ] 71% | 38.08 sec | GridSearchCV     [............................            ] 71% | 38.31 sec | GridSearchCV     [............................            ] 71% | 38.59 sec | GridSearchCV     [............................            ] 71% | 38.82 sec | GridSearchCV     [............................            ] 71% | 39.03 sec | GridSearchCV     [............................            ] 71% | 39.24 sec | GridSearchCV     [............................            ] 72% | 39.46 sec | GridSearchCV     [............................            ] 72% | 39.67 sec | GridSearchCV     [............................            ] 72% | 39.94 sec | GridSearchCV     [............................            ] 72% | 40.23 sec | GridSearchCV     [............................            ] 72% | 40.45 sec | GridSearchCV     [.............................           ] 73% | 40.68 sec | GridSearchCV     [.............................           ] 73% | 40.91 sec | GridSearchCV     [.............................           ] 73% | 41.15 sec | GridSearchCV     [.............................           ] 73% | 41.42 sec | GridSearchCV     [.............................           ] 73% | 41.66 sec | GridSearchCV     [.............................           ] 74% | 41.92 sec | GridSearchCV     [.............................           ] 74% | 42.19 sec | GridSearchCV     [.............................           ] 74% | 42.47 sec | GridSearchCV     [.............................           ] 74% | 42.69 sec | GridSearchCV     [.............................           ] 74% | 42.89 sec | GridSearchCV     [.............................           ] 74% | 43.09 sec | GridSearchCV     [.............................           ] 75% | 43.39 sec | GridSearchCV     [.............................           ] 75% | 43.60 sec | GridSearchCV     [..............................          ] 75% | 43.80 sec | GridSearchCV     [..............................          ] 75% | 43.92 sec | GridSearchCV     [..............................          ] 75% | 44.03 sec | GridSearchCV     [..............................          ] 76% | 44.13 sec | GridSearchCV     [..............................          ] 76% | 44.21 sec | GridSearchCV     [..............................          ] 76% | 44.30 sec | GridSearchCV     [..............................          ] 76% | 44.38 sec | GridSearchCV     [..............................          ] 76% | 44.46 sec | GridSearchCV     [..............................          ] 76% | 44.57 sec | GridSearchCV     [..............................          ] 77% | 44.68 sec | GridSearchCV     [..............................          ] 77% | 44.78 sec | GridSearchCV     [..............................          ] 77% | 44.87 sec | GridSearchCV     [..............................          ] 77% | 44.95 sec | GridSearchCV     [..............................          ] 77% | 45.04 sec | GridSearchCV     [...............................         ] 78% | 45.15 sec | GridSearchCV     [...............................         ] 78% | 45.26 sec | GridSearchCV     [...............................         ] 78% | 45.34 sec | GridSearchCV     [...............................         ] 78% | 45.42 sec | GridSearchCV     [...............................         ] 78% | 45.51 sec | GridSearchCV     [...............................         ] 79% | 45.59 sec | GridSearchCV     [...............................         ] 79% | 45.68 sec | GridSearchCV     [...............................         ] 79% | 45.77 sec | GridSearchCV     [...............................         ] 79% | 45.86 sec | GridSearchCV     [...............................         ] 79% | 45.94 sec | GridSearchCV     [...............................         ] 79% | 46.03 sec | GridSearchCV     [...............................         ] 80% | 46.13 sec | GridSearchCV     [...............................         ] 80% | 46.25 sec | GridSearchCV     [................................        ] 80% | 46.35 sec | GridSearchCV     [................................        ] 80% | 46.45 sec | GridSearchCV     [................................        ] 80% | 46.57 sec | GridSearchCV     [................................        ] 81% | 46.69 sec | GridSearchCV     [................................        ] 81% | 46.79 sec | GridSearchCV     [................................        ] 81% | 46.89 sec | GridSearchCV     [................................        ] 81% | 47.00 sec | GridSearchCV     [................................        ] 81% | 47.09 sec | GridSearchCV     [................................        ] 81% | 47.21 sec | GridSearchCV     [................................        ] 82% | 47.32 sec | GridSearchCV     [................................        ] 82% | 47.42 sec | GridSearchCV     [................................        ] 82% | 47.56 sec | GridSearchCV     [................................        ] 82% | 47.69 sec | GridSearchCV     [................................        ] 82% | 47.80 sec | GridSearchCV     [.................................       ] 83% | 47.97 sec | GridSearchCV     [.................................       ] 83% | 48.09 sec | GridSearchCV     [.................................       ] 83% | 48.20 sec | GridSearchCV     [.................................       ] 83% | 48.32 sec | GridSearchCV     [.................................       ] 83% | 48.44 sec | GridSearchCV     [.................................       ] 84% | 48.61 sec | GridSearchCV     [.................................       ] 84% | 48.77 sec | GridSearchCV     [.................................       ] 84% | 48.93 sec | GridSearchCV     [.................................       ] 84% | 49.08 sec | GridSearchCV     [.................................       ] 84% | 49.24 sec | GridSearchCV     [.................................       ] 84% | 49.40 sec | GridSearchCV     [.................................       ] 85% | 49.66 sec | GridSearchCV     [.................................       ] 85% | 49.86 sec | GridSearchCV     [..................................      ] 85% | 50.02 sec | GridSearchCV     [..................................      ] 85% | 50.19 sec | GridSearchCV     [..................................      ] 85% | 50.39 sec | GridSearchCV     [..................................      ] 86% | 50.57 sec | GridSearchCV     [..................................      ] 86% | 50.77 sec | GridSearchCV     [..................................      ] 86% | 50.98 sec | GridSearchCV     [..................................      ] 86% | 51.19 sec | GridSearchCV     [..................................      ] 86% | 51.40 sec | GridSearchCV     [..................................      ] 86% | 51.60 sec | GridSearchCV     [..................................      ] 87% | 51.82 sec | GridSearchCV     [..................................      ] 87% | 52.00 sec | GridSearchCV     [..................................      ] 87% | 52.18 sec | GridSearchCV     [..................................      ] 87% | 52.35 sec | GridSearchCV     [..................................      ] 87% | 52.51 sec | GridSearchCV     [...................................     ] 88% | 52.73 sec | GridSearchCV     [...................................     ] 88% | 52.90 sec | GridSearchCV     [...................................     ] 88% | 53.07 sec | GridSearchCV     [...................................     ] 88% | 53.25 sec | GridSearchCV     [...................................     ] 88% | 53.41 sec | GridSearchCV     [...................................     ] 89% | 53.59 sec | GridSearchCV     [...................................     ] 89% | 53.75 sec | GridSearchCV     [...................................     ] 89% | 53.91 sec | GridSearchCV     [...................................     ] 89% | 54.07 sec | GridSearchCV     [...................................     ] 89% | 54.23 sec | GridSearchCV     [...................................     ] 89% | 54.39 sec | GridSearchCV     [...................................     ] 90% | 54.55 sec | GridSearchCV     [...................................     ] 90% | 54.71 sec | GridSearchCV     [....................................    ] 90% | 54.87 sec | GridSearchCV     [....................................    ] 90% | 55.03 sec | GridSearchCV     [....................................    ] 90% | 55.19 sec | GridSearchCV     [....................................    ] 91% | 55.35 sec | GridSearchCV     [....................................    ] 91% | 55.51 sec | GridSearchCV     [....................................    ] 91% | 55.70 sec | GridSearchCV     [....................................    ] 91% | 55.86 sec | GridSearchCV     [....................................    ] 91% | 56.02 sec | GridSearchCV     [....................................    ] 91% | 56.17 sec | GridSearchCV     [....................................    ] 92% | 56.33 sec | GridSearchCV     [....................................    ] 92% | 56.65 sec | GridSearchCV     [....................................    ] 92% | 56.97 sec | GridSearchCV     [....................................    ] 92% | 57.30 sec | GridSearchCV     [....................................    ] 92% | 57.61 sec | GridSearchCV     [.....................................   ] 93% | 57.93 sec | GridSearchCV     [.....................................   ] 93% | 58.25 sec | GridSearchCV     [.....................................   ] 93% | 58.57 sec | GridSearchCV     [.....................................   ] 93% | 58.89 sec | GridSearchCV     [.....................................   ] 93% | 59.20 sec | GridSearchCV     [.....................................   ] 94% | 59.52 sec | GridSearchCV     [.....................................   ] 94% | 59.84 sec | GridSearchCV     [.....................................   ] 94% | 60.17 sec | GridSearchCV     [.....................................   ] 94% | 60.52 sec | GridSearchCV     [.....................................   ] 94% | 60.90 sec | GridSearchCV     [.....................................   ] 94% | 61.22 sec | GridSearchCV     [.....................................   ] 95% | 61.53 sec | GridSearchCV     [.....................................   ] 95% | 61.85 sec | GridSearchCV     [......................................  ] 95% | 62.17 sec | GridSearchCV     [......................................  ] 95% | 62.49 sec | GridSearchCV     [......................................  ] 95% | 62.81 sec | GridSearchCV     [......................................  ] 96% | 63.13 sec | GridSearchCV     [......................................  ] 96% | 63.44 sec | GridSearchCV     [......................................  ] 96% | 63.76 sec | GridSearchCV     [......................................  ] 96% | 64.08 sec | GridSearchCV     [......................................  ] 96% | 64.41 sec | GridSearchCV     [......................................  ] 96% | 64.76 sec | GridSearchCV     [......................................  ] 97% | 65.11 sec | GridSearchCV     [......................................  ] 97% | 65.46 sec | GridSearchCV     [......................................  ] 97% | 65.80 sec | GridSearchCV     [......................................  ] 97% | 66.12 sec | GridSearchCV     [......................................  ] 97% | 66.43 sec | GridSearchCV     [....................................... ] 98% | 66.78 sec | GridSearchCV     [....................................... ] 98% | 67.16 sec | GridSearchCV     [....................................... ] 98% | 67.53 sec | GridSearchCV     [....................................... ] 98% | 67.93 sec | GridSearchCV     [....................................... ] 98% | 68.27 sec | GridSearchCV     [....................................... ] 99% | 68.61 sec | GridSearchCV     [....................................... ] 99% | 68.96 sec | GridSearchCV     [....................................... ] 99% | 69.29 sec | GridSearchCV     [....................................... ] 99% | 69.61 sec | GridSearchCV     [....................................... ] 99% | 69.95 sec | GridSearchCV     [....................................... ] 99% | 70.29 sec | GridSearchCV     [....................................... ] 100% | 70.71 sec | GridSearchCV     [....................................... ] 100% | 71.14 sec | GridSearchCV     [........................................] 100% | 71.54 sec | GridSearchCV


Print the results of the grid search.



.. code-block:: python


    print("\nBest parameters set found over cross-validation:\n")
    print(gscv.best_params_)





.. rst-class:: sphx-glr-script-out

 Out::

    Best parameters set found over cross-validation:

    {'add__delay': 0, 'dar__ordar': 90, 'dar__ordriv': 2, 'driver__low_fq': 5.0, 'driver__low_fq_width': 1.0}


Plot the results of the grid search.

As we grid-searched over many dimensions, the results are not easy to
visualize. That's why we choose two params to plot and the other are set to
their best values.



.. code-block:: python



    def plot_results(index='dar__ordar', columns='dar__ordriv'):
        """Select two hyperparameters from which we plot the fluctuations"""
        index = 'param_' + index
        columns = 'param_' + columns

        # prepare the results into a pandas.DataFrame
        df = pd.DataFrame(gscv.cv_results_)

        # Remove the other by selecting their best values (from gscv.best_params_)
        other = [c for c in df.columns if c[:6] == 'param_']
        other.remove(index)
        other.remove(columns)
        for col in other:
            df = df[df[col] == gscv.best_params_[col[6:]]]

        # Create pivot tables for easy plotting
        table_mean = df.pivot_table(index=index, columns=columns,
                                    values=['mean_test_score'])
        table_std = df.pivot_table(index=index, columns=columns,
                                   values=['std_test_score'])

        # plot the pivot tables
        plt.figure()
        ax = plt.gca()
        for col_mean, col_std in zip(table_mean.columns, table_std.columns):
            table_mean[col_mean].plot(ax=ax, yerr=table_std[col_std], marker='o',
                                      label=col_mean)
        plt.title('Grid-search results (higher is better)')
        plt.ylabel('log-likelihood compared to an AR(0)')
        plt.legend(title=table_mean.columns.names)
        plt.show()


    plot_results(index='dar__ordar', columns='dar__ordriv')
    plot_results(index='driver__low_fq', columns='driver__low_fq_width')



.. rst-class:: sphx-glr-horizontal


    *

      .. image:: /auto_examples/images/sphx_glr_plot_grid_search_001.png
            :scale: 47

    *

      .. image:: /auto_examples/images/sphx_glr_plot_grid_search_002.png
            :scale: 47




**Total running time of the script:** ( 1 minutes  13.229 seconds)



.. container:: sphx-glr-footer


  .. container:: sphx-glr-download

     :download:`Download Python source code: plot_grid_search.py <plot_grid_search.py>`



  .. container:: sphx-glr-download

     :download:`Download Jupyter notebook: plot_grid_search.ipynb <plot_grid_search.ipynb>`

.. rst-class:: sphx-glr-signature

    `Generated by Sphinx-Gallery <https://sphinx-gallery.readthedocs.io>`_
